function localStorage(e){window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.indexedDB||window.alert("Your browser does not support a stable version of IndexedDB");var t=window.indexedDB.open(e.DB_NAME,e.DB_VERSION),r=null;t.onupgradeneeded=function(){r=event.target.result;for(var t in e.TABLES){var o=r.createObjectStore(e.TABLES[t].TBL_NAME,{autoIncrement:!0});for(var n in e.TABLES[t].INDEXS)o.createIndex(e.TABLES[t].INDEXS[n][0],e.TABLES[t].INDEXS[n][0],{unique:e.TABLES[t].INDEXS[n][1]})}},t.onsuccess=function(){r=event.target.result},t.onerror=function(){window.alert("Could not connect to the database")},validation=function(t,r){for(var o in e.TABLES)if(e.TABLES[o].TBL_NAME==t)for(var n in e.TABLES[o].INDEXS){varifyFields=!1;for(var a in r)e.TABLES[o].INDEXS[n][0]==a&&""!=r[a]&&(varifyFields=!0);if(!varifyFields)return{field:e.TABLES[o].INDEXS[n][0],response:!1}}return{response:!0}},localStorage.prototype.insert=function(e,t,o){var n=r.transaction(e,"readwrite"),a=n.objectStore(e);if(responseValid=validation(e,t),!responseValid.response)return o({type:"error",message:"Field "+responseValid.field+" is required"}),!1;var s,i=a.add(t);i.onsuccess=function(e){s={type:e.type,message:"done",id:e.target.result},o(s)},i.onerror=function(e){s={type:e.type,message:e.target.error.message},o(s)}},localStorage.prototype.del=function(e,t,o){var n,a=r.transaction(e,"readwrite"),s=a.objectStore(e),i=s["delete"](t);i.onsuccess=function(e){n={type:e.type,message:"done"},o(n)},i.onerror=function(e){n={type:e.type,message:e.target.error.message},o(n)}},localStorage.prototype.get=function(e,t,o){var n,a=r.transaction(e,"readonly"),s=a.objectStore(e),i=s.get(t);i.onsuccess=function(e){n={type:e.type,message:"done",data:e.target.result},o(n)},i.onerror=function(e){n={type:e.type,message:e.target.error.message},o(n)}},localStorage.prototype.put=function(e,t,o,n){var a,s=r.transaction(e,"readwrite"),i=s.objectStore(e),d=i.get(t);d.onsuccess=function(r){if(dataUpdate=d.result,void 0==dataUpdate)return n({type:"error",message:"Insertion not Exist"}),!1;for(var s in dataUpdate){dataUpdate[s];for(var c in o){var u=o[c];s==c&&(dataUpdate[s]=u)}}if(responseValid=validation(e,dataUpdate),!responseValid.response)return n({type:"error",message:"Field "+responseValid.field+" is required"}),!1;var p=i.put(dataUpdate,t);p.onsuccess=function(e){a={type:e.type,message:"done",data:e.target.result},n(a)},p.onerror=function(e){a={type:e.type,message:e.target.error.message},n(a)}},d.onerror=function(e){a={type:e.type,message:e.target.error.message},n(a)}},localStorage.prototype.getAll=function(e,t){var o=r.transaction(e,"readonly"),n=o.objectStore(e),a=[],s=n.openCursor();s.onsuccess=function(e){var r=e.target.result;r&&null!=r&&void 0!=r.value?(r.value.id=r.key,a.push(r.value),r["continue"]()):t(a)},s.onerror=function(e){a={type:e.type,message:e.target.error.message},t(a)}},localStorage.prototype.getByIndex=function(e,t,o,n){var a=r.transaction(e,"readonly"),s=a.objectStore(e);indexTest=!1;for(var i in s.indexNames)s.indexNames[i]==t&&(indexTest=!0);if(!indexTest)return n({type:"error",message:"Index not Exist"}),!1;var d,c=s.index(t),u=c.get(o);u.onsuccess=function(e){d={type:e.type,message:"done",data:e.target.result},n(d)},u.onerror=function(e){d={type:e.type,message:e.target.error.message},n(d)}}}